--- mcp/mcp.go.bak	2025-06-04 12:00:00.000000000 +0000
+++ mcp/mcp.go	2025-06-04 12:00:00.000000000 +0000
@@ -232,8 +232,19 @@
 
 			// Look for a pending request with this ID
 			if response.ID \!= nil {
+				// Convert JSON number ID (float64) to int if needed
+				var lookupID any = response.ID
+				if floatID, ok := response.ID.(float64); ok {
+					lookupID = int(floatID)
+					m.writeToStderr(fmt.Sprintf("Converting float64 ID %v to int %v\n", floatID, lookupID))
+				}
+				
 				m.pendingMtx.RLock()
-				req, ok := m.pending[response.ID]
+				req, ok := m.pending[lookupID]
+				if \!ok && lookupID \!= response.ID {
+					// Try with original ID if conversion didn't match
+					req, ok = m.pending[response.ID]
+				}
 				m.pendingMtx.RUnlock()
 
 				if ok {
@@ -251,7 +262,12 @@
 					// For requests that only need the first response, we can clean up
 					// More complex protocols might need to keep the request around for multiple responses
 					m.pendingMtx.Lock()
-					delete(m.pending, response.ID)
+					// Delete by the lookup ID we used to find it
+					if floatID, ok := response.ID.(float64); ok {
+						delete(m.pending, int(floatID))
+					} else {
+						delete(m.pending, response.ID)
+					}
 					m.pendingMtx.Unlock()
 
 					if req.timeout \!= nil {
